from chacha20poly1305 import ChaCha20Poly1305

# See https://pypi.org/project/chacha20poly1305/

key = bytearray([ 0x87, 0x20, 0xe8, 0x62, 0x76, 0x29, 0xc2, 0x85,
                  0x85, 0x02, 0x30, 0xfe, 0xfa, 0x32, 0x36, 0x57,
                  0x28, 0x97, 0x32, 0xcb, 0x9f, 0x00, 0xa6, 0x79,
                  0xd5, 0x20, 0x61, 0x60, 0x45, 0x4d, 0x84, 0xd0 ])
iv = bytearray([0,0,0,0,0,0,0,0,0,0,0,0])
cip = ChaCha20Poly1305(key)

ciphertext = cip.encrypt(iv, b'abcd')
print(ciphertext)

plaintext = cip.decrypt(iv, ciphertext)
print(plaintext)
